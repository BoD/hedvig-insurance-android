query EmbarkStory($name: String!) {
  embarkStory(name: $name) {
    startPassage
    passages {
      name
      id
      messages {
        expressions {
          ...ExpressionFragment
        }
        text
      }
      action {
        ... on EmbarkSelectAction {
          data {
            options {
              link {
                name
                label
              }
              keys
              values
            }
          }
        }
      }
    }
  }
}

fragment ExpressionFragment on EmbarkExpression {
  ... on EmbarkExpressionUnary {
    unaryType: type
    text
  }
  ... on EmbarkExpressionBinary {
    binaryType: type
    key
    value
    text
  }
  ... on EmbarkExpressionMultiple {
    multipleType: type
    text
    subExpressions {
      ... on EmbarkExpressionUnary {
        unaryType: type
        text
      }
      ... on EmbarkExpressionBinary {
        binaryType: type
        key
        value
        text
      }
      ... on EmbarkExpressionMultiple {
        multipleType: type
        text
        subExpressions {
          ... on EmbarkExpressionUnary {
            unaryType: type
            text
          }
          ... on EmbarkExpressionBinary {
            binaryType: type
            key
            value
            text
          }
        }
      }
    }
  }
}
